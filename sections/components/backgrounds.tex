\subsection{Background Subtraction}
\label{sec:backgrounds}

Our low-level background subtraction algorithms (in the \texttt{meas\_algorithms} package) operate by binning images, masking out detections and bad pixels, and computing robust statistics (clipped means, by default) on the remaining values in those bins.
The bin averages can then be interpolated via Akima splines or approximated by Chebyshev polynomials.

This code is run and re-run in many different configurations in many different contexts.
For example, it is the first step run after instrument signature removal (\S\ref{sec:isr}) on each detector in both the nightly and data release pipelines.
In a full DRP it is also run across a full visit to remove large-scale background features \citep{2019PASJ...71..114A}.
We sometimes also run background subtraction on coadds before detecting objects on them, especially when only full-visit backgrounds were subtracted from the input images.

In addition, we routinely run background subtraction as a small tweak every time we run detection (\S\ref{sec:detection}).
We \emph{define} our background to be the sum of all light that we do not consider part of a detection, which means it needs to be adjusted when the detection threshold changes (e.g. when we detect fainter objects on coadds).
